<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Church Data Dashboard</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Church Data Dashboard</h1>

    <!-- Dropdown to select the sheet -->
    <label for="sheetSelect">Select Sheet:</label>
    <select id="sheetSelect">
        <option value="Members">Members</option>
        <option value="Event Calendar">Event Calendar</option>
        <option value="G12 Leaders">G12 Leaders</option>
        <option value="Care Takers">Care Takers</option>
        <option value="New Members">New Members</option>
        <option value="Sunday School Children">Sunday School Children</option>
        <option value="Attendance & Participation">Attendance & Participation</option>
        <option value="Ministry and Department">Ministry and Department</option>
        <option value="Nutrition Programs">Nutrition Programs</option>
    </select>
    <button onclick="fetchSheetData()">Load Data</button>

    <!-- This div will display the data from Google Sheets -->
    <div id="sheetData">Please select a sheet and click "Load Data".</div>

    <!-- Link to the JavaScript file -->
    <script>
        async function fetchSheetData() {
            const sheetName = document.getElementById('sheetSelect').value;
            const url = `https://script.google.com/macros/s/AKfycbx4KNCENhcYFDb_EwszI5gIlmoQkV5ozu0Zm_Q0AsvjKU6eSj55mOh6m7jHmopEkDVEBw/exec?sheetName=${encodeURIComponent(sheetName)}`;
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                // Clear previous data
                const sheetDataDiv = document.getElementById('sheetData');
                sheetDataDiv.innerHTML = "";

                if (data.error) {
                    sheetDataDiv.innerHTML = `<p>Error: ${data.error}</p>`;
                    return;
                }

                // Create a table to display the data
                const table = document.createElement('table');
                const headerRow = document.createElement('tr');

                // Add table headers (Column1, Column2, etc.)
                const headers = Object.keys(data[0]);
                headers.forEach(header => {
                    const th = document.createElement('th');
                    th.textContent = header;
                    headerRow.appendChild(th);
                });
                table.appendChild(headerRow);

                // Add data rows
                data.forEach(row => {
                    const tr = document.createElement('tr');
                    headers.forEach(header => {
                        const td = document.createElement('td');
                        td.textContent = row[header];
                        tr.appendChild(td);
                    });
                    table.appendChild(tr);
                });

                // Append the table to the sheetData div
                sheetDataDiv.appendChild(table);

            } catch (error) {
                document.getElementById('sheetData').innerHTML = `<p>Error fetching data: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
